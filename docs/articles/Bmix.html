<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BMix">
<title>Using BMix • BMix</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using BMix">
<meta property="og:description" content="BMix">
<meta property="og:image" content="https://caravagnalab.github.io/BMix/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BMix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/BMix.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/caravagnalab/BMix/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using BMix</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/BMix/blob/HEAD/vignettes/BMix.Rmd" class="external-link"><code>vignettes/BMix.Rmd</code></a></small>
      <div class="d-none name"><code>BMix.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagnalab/BMix" class="external-link">BMix</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: replacing previous import 'cli::num_ansi_colors' by</span>
<span class="co">#&gt; 'crayon::num_ansi_colors' when loading 'BMix'</span>
<span class="co">#&gt; Warning: replacing previous import 'crayon::%+%' by 'ggplot2::%+%' when loading</span>
<span class="co">#&gt; 'BMix'</span>
<span class="co">#&gt; <span style="color: #00BB00;">✓</span> Loading <span style="color: #00BB00;">BMix</span>, <span style="font-style: italic;">'Binomial and Beta-Binomial univariate mixtures'</span>. Support : <span style="color: #0000BB; font-style: italic;">&lt;https://caravagnalab.github.io/BMix/&gt;</span></span></code></pre></div>
<div class="section level2">
<h2 id="mixture-models-with-bmix">Mixture models with BMix<a class="anchor" aria-label="anchor" href="#mixture-models-with-bmix"></a>
</h2>
<div class="section level3">
<h3 id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h3>
<p>We generate some simple data obtained from <span class="math inline">\(k=3\)</span> Binomial mixtures with Binomial probability <span class="math inline">\(p\in\{ 0.5, 0.25, 0.1\}\)</span>, drawing <span class="math inline">\(300\)</span>, <span class="math inline">\(700\)</span> and <span class="math inline">\(700\)</span> samples each. The number of trials is fixed to <span class="math inline">\(100\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  successes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">100</span>, <span class="fl">.5</span><span class="op">)</span>,  <span class="co"># First component - 300 points, peak at 0.5</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">700</span>, <span class="fl">100</span>, <span class="fl">.25</span><span class="op">)</span>, <span class="co"># Second component - 700 points, peak at 0.25</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">700</span>, <span class="fl">100</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Third component - 700 points, peak at 0.1</span>
  trials <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   successes trials</span>
<span class="co">#&gt; 1        55    100</span>
<span class="co">#&gt; 2        43    100</span>
<span class="co">#&gt; 3        53    100</span>
<span class="co">#&gt; 4        55    100</span>
<span class="co">#&gt; 5        51    100</span>
<span class="co">#&gt; 6        59    100</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">successes</span><span class="op">/</span><span class="va">trials</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-3-1.png" width="288"></p>
</div>
<div class="section level3">
<h3 id="binomial-mixtures">Binomial mixtures<a class="anchor" aria-label="anchor" href="#binomial-mixtures"></a>
</h3>
<div class="section level4">
<h4 id="fitting-the-data">Fitting the data<a class="anchor" aria-label="anchor" href="#fitting-the-data"></a>
</h4>
<p>Fitting is done with function <code>bmixfit</code>, the default parameters test a number of configurations of Binomial components, but sets to <span class="math inline">\(0\)</span> the number of Beta-Binomial components.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Default parameters</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/bmixfit.html">bmixfit</a></span><span class="op">(</span><span class="va">data</span>, K.Binomials <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, K.BetaBinomials <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">BMix fit</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Binomials k_B = <span style="color: #00BB00;">1</span>, <span style="color: #00BB00;">2</span>, and <span style="color: #00BB00;">3</span>, Beta-Binomials k_BB = <span style="color: #00BB00;">0</span>; 6 fits to run.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">Bmix best fit</span> completed in 0.02 mins</span>
<span class="co">#&gt; ── <span style="color: #000000; background-color: #BBBB00;">[ BMix ] My BMix model</span> n = 1700 with <span style="color: #00BB00;">k = 3</span> component(s) (<span style="color: #00BB00;">3</span> + <span style="color: #00BB00;">0</span>) ─────────────</span>
<span class="co">#&gt; • Clusters: π = 42% [<span style="color: #BBBB00;">Bin 2</span>], 41% [<span style="color: #BBBB00;">Bin 3</span>], and 18% [<span style="color: #BBBB00;">Bin 1</span>], with π &gt; 0.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 1</span> with mean = 0.497648592976857.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 2</span> with mean = 0.101526812716731.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 3</span> with mean = 0.248839045631862.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Score (model selection): <span style="color: #00BB00;">ICL</span> = 13247.2.</span>

<span class="co"># Maybe one could compare x to this</span>
<span class="co"># y = bmixfit(data, K.Binomials = 0, K.BetaBinomials = 1:2)</span></code></pre></div>
<p>The fit is an object of class <code>bmix</code> which has S3 methods available.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="color: #000000; background-color: #BBBB00;">[ BMix ] My BMix model</span> n = 1700 with <span style="color: #00BB00;">k = 3</span> component(s) (<span style="color: #00BB00;">3</span> + <span style="color: #00BB00;">0</span>) ─────────────</span>
<span class="co">#&gt; • Clusters: π = 42% [<span style="color: #BBBB00;">Bin 2</span>], 41% [<span style="color: #BBBB00;">Bin 3</span>], and 18% [<span style="color: #BBBB00;">Bin 1</span>], with π &gt; 0.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 1</span> with mean = 0.497648592976857.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 2</span> with mean = 0.101526812716731.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 3</span> with mean = 0.248839045631862.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Score (model selection): <span style="color: #00BB00;">ICL</span> = 13247.2.</span></code></pre></div>
<p><strong>Note:</strong> The input data is not stored inside the fit, you have keep it and pass it to plotting functions. Keep it consistent, the package is not doing any checks about the input.</p>
<p>You have getters to access the clusters (as <code>tibble</code>) and the fit parameters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Augment data with cluster labels and latent variables</span>
<span class="fu"><a href="../reference/Clusters.html">Clusters</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,700 × 6</span></span>
<span class="co">#&gt;    successes trials cluster `Bin 1`  `Bin 2`  `Bin 3`</span>
<span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>        55    100 Bin 1     1.00  2.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-24</span> 1.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>        43    100 Bin 1     0.999 2.42<span style="color: #949494;">e</span><span style="color: #BB0000;">-13</span> 5.39<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>        53    100 Bin 1     1.00  1.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-22</span> 1.38<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>        55    100 Bin 1     1.00  2.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-24</span> 1.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>        51    100 Bin 1     1.00  1.14<span style="color: #949494;">e</span><span style="color: #BB0000;">-20</span> 1.81<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>        59    100 Bin 1     1.00  5.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-28</span> 6.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-13</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>        44    100 Bin 1     1.00  2.93<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span> 1.49<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        50    100 Bin 1     1.00  9.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-20</span> 6.56<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>        52    100 Bin 1     1.00  1.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-21</span> 4.99<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        49    100 Bin 1     1.00  7.72<span style="color: #949494;">e</span><span style="color: #BB0000;">-19</span> 2.38<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1,690 more rows</span></span>

<span class="co"># Obtain for every fit component the mean and its overdispersion.</span>
<span class="co"># Binomial components have 0 overdispersion by definition.</span>
<span class="fu"><a href="../reference/Parameters.html">Parameters</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">#&gt;   cluster  mean overdispersion</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Bin 1   0.498              0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Bin 2   0.102              0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Bin 3   0.249              0</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotting-the-fits">Plotting the fits<a class="anchor" aria-label="anchor" href="#plotting-the-fits"></a>
</h4>
<p>You can plot the clustering assignments (<em>hard clustering</em>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_clusters.html">plot_clusters</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span></code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-7-1.png" width="288"></p>
<p>You can plot the density, in frequency space. For this a number of trials needs to be fixed; by default <code>BMix</code> takes the median number of trials in the input data, but you can decide to use any other interger number.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span></code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-8-1.png" width="288"></p>
<p>You can visualise the result of the model selection grid as a heatmap; the best model is the one that minimizes the chosen score, which is by default the <em>Integrated Classification Likelihood</em>, an extension of the <em>Bayesian Information Criterion</em> that accounts for the entropy of the latent variables.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_model_selection.html">plot_model_selection</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-9-1.png" width="288"></p>
<p>Then <code>plot</code> assembles all these plots using the <code>cowplot</code> package.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">BMix</span><span class="fu">::</span><span class="fu"><a href="../reference/plot.bmix.html">plot.bmix</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span> </code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-10-1.png" width="864"></p>
</div>
</div>
<div class="section level3">
<h3 id="beta-binomial-mixtures">Beta-Binomial mixtures<a class="anchor" aria-label="anchor" href="#beta-binomial-mixtures"></a>
</h3>
<p>If you want to test the same model with only Beta-Binomial components you can run function <code>bmixfit</code> as follows.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Custom parameters</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/bmixfit.html">bmixfit</a></span><span class="op">(</span><span class="va">data</span>, 
            K.Binomials <span class="op">=</span> <span class="fl">0</span>, 
            K.BetaBinomials <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">BMix fit</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Binomials k_B = <span style="color: #00BB00;">0</span>, Beta-Binomials k_BB = <span style="color: #00BB00;">1</span>, <span style="color: #00BB00;">2</span>, and <span style="color: #00BB00;">3</span>; 6 fits to run.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">Bmix best fit</span> completed in 0.15 mins</span>
<span class="co">#&gt; ── <span style="color: #000000; background-color: #BBBB00;">[ BMix ] My BMix model</span> n = 1700 with <span style="color: #00BB00;">k = 3</span> component(s) (<span style="color: #00BB00;">0</span> + <span style="color: #00BB00;">3</span>) ─────────────</span>
<span class="co">#&gt; • Clusters: π = 41% [<span style="color: #BBBB00;">BBin 3</span>], 41% [<span style="color: #BBBB00;">BBin 1</span>], and 18% [<span style="color: #BBBB00;">BBin 2</span>], with π &gt; 0.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Score (model selection): <span style="color: #00BB00;">ICL</span> = 13091.42.</span>

<span class="co"># Show outputs</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="color: #000000; background-color: #BBBB00;">[ BMix ] My BMix model</span> n = 1700 with <span style="color: #00BB00;">k = 3</span> component(s) (<span style="color: #00BB00;">0</span> + <span style="color: #00BB00;">3</span>) ─────────────</span>
<span class="co">#&gt; • Clusters: π = 41% [<span style="color: #BBBB00;">BBin 3</span>], 41% [<span style="color: #BBBB00;">BBin 1</span>], and 18% [<span style="color: #BBBB00;">BBin 2</span>], with π &gt; 0.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Score (model selection): <span style="color: #00BB00;">ICL</span> = 13091.42.</span>

<span class="fu">BMix</span><span class="fu">::</span><span class="fu"><a href="../reference/plot.bmix.html">plot.bmix</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span> </code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
</div>
<div class="section level3">
<h3 id="comparing-mixtures">Comparing mixtures<a class="anchor" aria-label="anchor" href="#comparing-mixtures"></a>
</h3>
<p>You can compare models with both type of components.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Custom parameters</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/bmixfit.html">bmixfit</a></span><span class="op">(</span><span class="va">data</span>, 
            K.Binomials <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, 
            K.BetaBinomials <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">BMix fit</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Binomials k_B = <span style="color: #00BB00;">0</span>, <span style="color: #00BB00;">1</span>, <span style="color: #00BB00;">2</span>, and <span style="color: #00BB00;">3</span>, Beta-Binomials k_BB = <span style="color: #00BB00;">0</span>, <span style="color: #00BB00;">1</span>, <span style="color: #00BB00;">2</span>, and <span style="color: #00BB00;">3</span>; 12 fits to run.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">Bmix best fit</span> completed in 0.14 mins</span>
<span class="co">#&gt; ── <span style="color: #000000; background-color: #BBBB00;">[ BMix ] My BMix model</span> n = 1700 with <span style="color: #00BB00;">k = 3</span> component(s) (<span style="color: #00BB00;">3</span> + <span style="color: #00BB00;">0</span>) ─────────────</span>
<span class="co">#&gt; • Clusters: π = 42% [<span style="color: #BBBB00;">Bin 1</span>], 40% [<span style="color: #BBBB00;">Bin 3</span>], and 18% [<span style="color: #BBBB00;">Bin 2</span>], with π &gt; 0.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 1</span> with mean = 0.246907871295258.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 2</span> with mean = 0.498232166963041.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 3</span> with mean = 0.0991531012813286.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Score (model selection): <span style="color: #00BB00;">ICL</span> = 13016.61.</span>

<span class="co"># Show outputs</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="color: #000000; background-color: #BBBB00;">[ BMix ] My BMix model</span> n = 1700 with <span style="color: #00BB00;">k = 3</span> component(s) (<span style="color: #00BB00;">3</span> + <span style="color: #00BB00;">0</span>) ─────────────</span>
<span class="co">#&gt; • Clusters: π = 42% [<span style="color: #BBBB00;">Bin 1</span>], 40% [<span style="color: #BBBB00;">Bin 3</span>], and 18% [<span style="color: #BBBB00;">Bin 2</span>], with π &gt; 0.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 1</span> with mean = 0.246907871295258.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 2</span> with mean = 0.498232166963041.</span>
<span class="co">#&gt; • Binomial <span style="color: #00BB00;">Bin 3</span> with mean = 0.0991531012813286.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Score (model selection): <span style="color: #00BB00;">ICL</span> = 13016.61.</span>

<span class="fu">BMix</span><span class="fu">::</span><span class="fu"><a href="../reference/plot.bmix.html">plot.bmix</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span> </code></pre></div>
<p><img src="Bmix_files/figure-html/unnamed-chunk-12-1.png" width="864"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
